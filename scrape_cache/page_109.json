{"page_content": "\n<h1>Loop Calculations</h1>\n<div id=\"relatedtags\"></div>\n<p class=\"headingp\" style=\"font-size:30px;margin-bottom:20px;\">Version:MissionOS_2.0</p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">Go to\u00a0<strong>Data Manager</strong>\u00a0&gt;\u00a0<strong>Admin</strong> &gt; <strong>Data Object Configuration</strong>\u00a0&gt;\u00a0<strong>Object Definition</strong>, then click the\u00a0<strong>Model</strong>\u00a0tab to open the interface.</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">The Parent\u2019s subtype model is defined by a control flow statement which specifies iteration.</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">This allows operations to be executed repeatedly a fixed number of times (defined by the sensor_level/depth/position parameter).</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">\u00a0</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">Three components define the control flow:\u00a0<strong>Init (Initialization), Loop\u00a0</strong>and<strong>\u00a0End</strong>. To define the three components of the flow, click\u00a0<strong>Add Fields</strong>. </span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">These components are adapted to create different calculations, the most common of which is the cumulative sum of a particular field (as used in Inclinometers, SAAs and Extensometers).</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">In this manual, you are given instructions on how to add these three components.</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">\u00a0</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">The first step is to create the Parent\u2019s model to define the calculations required and name them.</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">For example, see calculation4 as shown in Figure 1 \u2013 these fields act as repositories for the calculations later defined in the loop.</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">\u00a0</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">In the following example, the values calculated are the cumulative deviation in A and B directions (cd_a and cd_b, respectively) and the resultant of both components (res).</span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">These are defined before the loop as calculation fields. </span></p>\n<p class=\"MGSBodyText\"><span lang=\"EN-US\">Refer to the figure below to view calculations 4 to 7.</span></p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img height=\"652\" src=\"db://images/487\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"1218\"/>\n<figcaption><strong>Figure </strong><strong>1</strong><strong>: Init, Loop and End components of Parent\u2019s Model</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<h2><strong>INIT</strong></h2>\n<p>Init (Initialization) is the assignment of an initial value for a variable.</p>\n<ol>\n<li>Click <strong>Add fields</strong>. <br/>Specific fields populate.</li>\n<li>Select Field Type as <strong>Calculation</strong>.</li>\n<li>Enter <strong>User field name</strong>, and <strong>User field label</strong> as \u201cinit\u201d and also in <strong>Description</strong> (which is optional).</li>\n<li>Enter the formulas in the <strong>Function</strong> box, separated by semi-colon.</li>\n<li>Type the Calculation Order as 1.</li>\n<li>Click <strong>Save</strong>.</li>\n</ol>\n<p>\u00a0</p>\n<p>In this particular example, calculations start from 0.</p>\n<p>So, type \u201cself.cd_a=0;self.cd_b=0.</p>\n<p><br/>The element \u201cself.\u201d refers to the current instance of the calculation that is defined.</p>\n<p>This means that the values of cd_a and cd_b at this point are 0.</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/488\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure </strong><strong>2</strong><strong>: Init</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p>NOTE:</p>\n<p>Loop Formula modifications based on Compound Instruments enhancements:</p>\n<ul>\n<li>Init, loop, and end formulas are delimited by <strong>Semicolon (;)</strong>. Earlier the delimiter was comma.</li>\n<li>You can use child data/calibrations along with calculations in loop formulas. You need to provide user field names of the same in loop.</li>\n<li>Use User Field Names in Loop Formula for referring master\u2019s calibration.</li>\n<li>Validations with regards to <strong>user field names</strong>, are that \u2013 you can use only <strong>underscores</strong> in that. No spaces, special characters or upper-case letters are allowed.</li>\n</ul>\n<p>\u00a0</p>\n<p>ROC and DWP calculations inside loop/end formulas:</p>\n<ul>\n<li>You can use RateOfChange() and DiffWithPrev() functions inside loop and end formulas, which was only applicable with normal instruments before.</li>\n<li>You can use ROC and DWP functions in loop formulas only for child calculations.</li>\n<li>You can use ROC and DWP functions in end formulas only for master calculations.</li>\n<li>For example, there is a ROC calculation in loop, child.roc_ab = rateOfChange(child.ab,constant). When calculating ROC, taking each child and its previous value and calculate its ROC.</li>\n<li>If it is using master calculation, it is calculated using current calculation and previous master calculation.</li>\n</ul>\n<p>\u00a0</p>\n<p>The Data/Calibration/Calculation/ROC/DWP and Standard Loop Methods are listed on the right-hand side as shown in the figure below:</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img height=\"399\" src=\"db://images/489\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"1485\"/>\n<figcaption><strong>Figure 3: Loop Formula - Function containing data/calibration/calculation/ROC/DWP fields</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p>LOOP</p>\n<p>In Loop, the second component in the flow, the formulas are evaluated for each child in turn.</p>\n<ol>\n<li>Click <strong>Add Fields</strong>. <br/>New fields populate.</li>\n<li>The <strong>Instrument Type</strong> appears selected as <strong>Standard</strong> by default.</li>\n<li>The <strong>System Field Name</strong> auto-populates by itself.</li>\n<li>To add a new calculation called \u201cloop\u201d, type the <strong>User field name</strong>, <strong>User field label</strong> and <strong>Description</strong> as \u201c<strong>loop</strong>\u201d.</li>\n<li>Now, enter the formulas in the <strong>Function</strong> (Formulas are separated by semi-colons)</li>\n<li>Enter Calculation Order as 2.</li>\n<li>Finally, click <strong>Save</strong>.</li>\n</ol>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/490\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 4: Defining Loop</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u201cself.\u201d depicts the current instance of the calculation.</p>\n<p>This means that self.cd_a defines the actual value of the calculation cd_a.</p>\n<p>\u00a0</p>\n<p>In the above case, it is equal to the current value of cd_a plus the value of cd_a from the Child subtype created previously.<br/><br/></p>\n<p>The system repeats the calculation for each of the individual sensors associated to this parent until it \u201cruns out\u201d of sensors. The order in which the sensors are placed in this iteration is defined by the depth/sensor level/position (now known as sensor_level) parameter, used in the Manage Setup File and the processing order.</p>\n<p>\u00a0</p>\n<p>Based on the example of formulas as shown in figure 5, Table 1 shows a numerical example of looping through three child instruments.\u00a0</p>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/491\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 5</strong><strong>: Example of formula</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p><img height=\"1071\" src=\"db://images/492\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"1238\"/></p>\n<p>\u00a0</p>\n<p>Some models do not need to perform calculations but simply need a dummy loop calculation so the loop is recognised as a loop.\u00a0 You can use self.nchild=0 in the init and self.nchild=self.nchild+1 in the loop to simply count the number of children.</p>\n<p>\u00a0</p>\n<h2>END<br/><br/></h2>\n<p>End is the final component in the flow, which indicates the end of the loop.</p>\n<p>To create the End calculations,</p>\n<ol>\n<li>Click Add Fields.</li>\n<li>Select Field Type as Calculation.</li>\n<li>Enter <strong>User field name</strong>, label and description as \u201cend\u201d.</li>\n<li>Leave the <strong>Function</strong> box blank with no formulas.</li>\n</ol>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img height=\"690\" src=\"db://images/493\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"1121\"/>\n<figcaption><strong>Figure 6: End</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<h4>Note:</h4>\n<ul>\n<li>Avoid any mathematical symbols in the field names. You can use underscores, for example, cd_a, but no hyphens, like in cd-a.</li>\n<li>Similarly, use all lowercase letters. Example: self.cd_a, not self.Cd_a.</li>\n</ul>\n<p>\u00a0</p>\n<h4>IMPORTANT:</h4>\n<p>You have the ability to edit the Init and End calculations even after loop calculations are created.\u00a0 You work on formulas in an external text editor with newlines after each \u201c;\u201d and then paste into a formula box (the newlines will be removed on saving and won\u2019t affect calculations.)</p>\n<p>In this example, the final configuration for the Parent Model is depicted as shown:</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/494\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 7</strong><strong>: Finished Parent/Master Model</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>Refer to the following figures to see the Child Subtype Model:</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/495\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 8</strong><strong>: Child Model</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/496\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 9</strong><strong>: Finished Child Model</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p>Once you define the models, proceed with the setup of instruments.</p>\n<p>Refer to the table for description about various Standard Loop Methods:</p>\n<p>\u00a0</p>\n<p><img height=\"1056\" src=\"db://images/497\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"1118\"/></p>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/498\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 10: Standard Loop Methods</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p>When you click a specific Standard Loop Method, a pop-up appears for that method containing the following fields:</p>\n<ul>\n<li><strong>Subtypes</strong>: indicates to select the child subtype.</li>\n<li><strong>Calculation fields</strong>: Once you select the subtype, calculations under that subtype get listed. You can select the needed one.</li>\n<li><strong>Filter Lower and Upper Bound</strong>: You can specify that the aggregating function should only consider a subset of the children. The subset is determined by a chosen field having values within a lower and upper bound. The boundaries of the limiting range can be specified using Position or Calibrations or Calculated calibrations.</li>\n<li><strong>Filter by Field</strong>: You can filter by fields used to set the boundaries.</li>\n</ul>\n<ul>\n<li style=\"list-style-type: none;\">\n<ol>\n<li>For example, if there are 20 children for a composite instrument whose positions start from 0 to 19, if the user needs min/max values only from Child 5 to 15, and you can filter lower and upper bound as parent calibrations. Give 5 and 15 for those calibrations and set \u2018Filter by Field\u2019 as Position.</li>\n<li>If there is no Lower and Upper bound provided, then the method returns the result by considering all the children.</li>\n<li>If there are lower and upper bound provided (set from parent calibrations), and there is no value set for it, then no result will generate.</li>\n<li>For the depth functions, there is a Return Field - the value which needs to be returned corresponding to the min/max result, which can be Position, Order or Depth (if any). For example, if return field is position, and max2() value get from child at Position 6, then the result will be 6.</li>\n</ol>\n</li>\n</ul>\n<p>\u00a0</p>\n<p>View the following figures to see the fields of specific Standard Loop Methods:</p>\n<ol>\n<li>Max2</li>\n</ol>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/499\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 11: max2 \u2013 Standard Loop Method</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<ol start=\"2\">\n<li>Max2_depth</li>\n</ol>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/500\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 12: max2_depth \u2013 Standard Loop Method</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p>Perform the following steps to enter the Standard Loop Method into the Function box while creating a Loop calculation:</p>\n<ol>\n<li>First select the specific Loop method from the Standard Loop Methods box.</li>\n<li>For example, if you choose <strong>max_ratio</strong>, the corresponding pop-up appears.</li>\n<li>In the pop-up, select from the fields:\n<ul>\n<li>Subtype</li>\n<li>Calculation field</li>\n<li>Review Level</li>\n<li>Review Direction</li>\n</ul>\n</li>\n<li>Finally, click <strong>Feed</strong>.<br/>The loop calculation lists in the Function box.</li>\n</ol>\n<p>\u00a0</p>\n<p>A comma \u201c,\u201d separates the method arguments all Standard loop methods. This means while creating a loop calculation, when you click a specific Standard Loop Method and feed it into the Function box, the specific parameters within that function is separated by commas.</p>\n<p>Refer to the figures below to view how the specific parameters appear within the Function box:</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img height=\"753\" src=\"db://images/501\" style=\"display: block; margin-left: auto; margin-right: auto;\" width=\"1313\"/>\n<figcaption><strong>Figure 13: Click Feed to enter the Standard Loop Method (max_ratio) to the Function box</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/502\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 14: max_ratio in Function box with delimiter as comma</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>\n<p>In contrast, the Loop formulas within the function is separated by semi-colon.</p>\n<p>Refer to the figure below:</p>\n<p>\u00a0</p>\n<figure class=\"image\" style=\"text-align: center;\"><img src=\"db://images/503\" style=\"display: block; margin-left: auto; margin-right: auto;\"/>\n<figcaption><strong>Figure 15: Example of a Loop formula</strong></figcaption>\n</figure>\n<p>\u00a0</p>\n<p>\u00a0</p>", "metadata": {"source": "https://www.maxwellgeosystems.com/manuals/demo-manual/manual-web-content-highlight.php?manual_id=180", "videos": []}}